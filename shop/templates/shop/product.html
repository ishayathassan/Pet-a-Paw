{% extends 'base.html' %}
{% load static %}
{% block css %}
    {# Add your custom CSS styles here if needed #}
{% endblock %}
{% block content %}
    <section class="h-100 h-custom" style="background-color: #f3f3f3;">
        <div class="container py-5 h-100">
            <div class="row g-4">
                <!-- Product Details -->
                <div class="col-lg-6" >
                    <div class="card card-registration card-registration-2" style="border-radius: 15px; background-color:rgb(209, 209, 209);"">
                        <div class="card-body p-5">
                            <img src="{{ product.image.url }}" class="card-img-top mx-auto d-block" alt="Product Image">
                            <div class="d-flex justify-content-between align-items-center mt-4">
                                <h2 class="det-text fw-bold" style="color:#D57800;">{{ product.name }}</h2>
                            </div>
                            <hr class="my-4">
                            <p class="card-text ss-text"><strong>Category:</strong> {{ product.category }}</p>
                            <p class="card-text ss-text"><strong>Price:</strong> ${{ product.price }}</p>
                            <p class="card-text ss-text"><strong>Quantity Left:</strong> {{ product.stock }}</p>
                            <p class="card-text ss-text"><strong>Details:</strong> {{ product.details }}</p>
                        </div>
                    </div>
                </div>
                <!-- Review Section -->
                <div class="col-lg-6 ">
                    <div class="card bg-grey p-5" style="border-radius: 15px; background-color: #a8a8a8;">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h2 class="ss-text fw-bold det-text" style="color:rgb(239, 239, 239);">Reviews</h2>
                        </div>
                        <hr class="my-4">
                        
                        <!-- Review Form -->
                        <form method="post" action="{% url 'submit_review' product.id %}">
                            {% csrf_token %}
                            <div class="mb-3">
                                <label for="reviewText" class="form-label" style="color:rgb(239, 239, 239);">Your Review:</label>
                                <textarea class="form-control" id="reviewText" name="reviewText" rows="3" required></textarea>
                            </div>
                             <!-- Add a select input for rating -->
                            <div class="mb-3">
                                <label for="rating" class="form-label" style="color:rgb(239, 239, 239);">Rating:</label>
                                <select id="rating" name="rating">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                </select>
                            </div>
                            <!-- Add additional fields for the review if needed -->
                            <button type="submit" class="btn brand search-button nav_text ms-2 mb-4" style="background-color: #D57800; border: none;"  name="submitReview">Submit Review</button>
                        </form>
                        
                        
                        
                            <!-- Display Existing Reviews -->
                        <div style="margin-top: 20px;">
                            {% for review in product_reviews %}
                                <div class="mb-4" style="border: 1px solid #ccc; border-radius: 8px; padding: 15px; background-color:rgb(209, 209, 209);">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <p style="font-weight: bold; margin: 0; color:#D57800;">{{ review.user.username }}</p>
                                        <p style="color: #666; margin: 0;">{{ review.created_at }}</p>
                                    </div>
                                    <div>
                                        <p style="color: #333; margin-top: 10px;">{{ review.text }}</p>
                                        <hr class="my-2">
                                        <p style="font-style: italic;">Rating: {{ review.rating }}</p>
                                    </div>
                                </div>
                                
                            {% endfor %}
                        </div>
                        <!-- Display a message if there are no reviews -->
                        {% if product_reviews|length == 0 %}
                            <p>No past reviews available for this product.</p>
                        {% endif %}


                    </div>
                </div>
            </div>
        </div>
    </section>
    {% include 'footer.html' %}
{% endblock %}
